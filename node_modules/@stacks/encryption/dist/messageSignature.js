"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decodeMessage = exports.encodeMessage = exports.hashMessage = void 0;
const sha256_1 = require("@noble/hashes/sha256");
const common_1 = require("@stacks/common");
const varuint_bitcoin_1 = require("varuint-bitcoin");
const chainPrefix = '\x18Stacks Message Signing:\n';
function hashMessage(message) {
    return common_1.Buffer.from((0, sha256_1.sha256)(encodeMessage(message)));
}
exports.hashMessage = hashMessage;
function encodeMessage(message) {
    const encoded = (0, varuint_bitcoin_1.encode)(common_1.Buffer.from(message).length);
    return common_1.Buffer.concat([common_1.Buffer.from(chainPrefix), encoded, common_1.Buffer.from(message)]);
}
exports.encodeMessage = encodeMessage;
function decodeMessage(encodedMessage) {
    const messageWithoutChainPrefix = encodedMessage.subarray(1 + 24);
    const decoded = (0, varuint_bitcoin_1.decode)(messageWithoutChainPrefix);
    const varIntLength = (0, varuint_bitcoin_1.encodingLength)(decoded);
    return messageWithoutChainPrefix.slice(varIntLength);
}
exports.decodeMessage = decodeMessage;
//# sourceMappingURL=messageSignature.js.map